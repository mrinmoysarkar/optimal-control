%S = sym('S%d%d', [4 4]);
% for i=1:4
%     for j=1:4
%         if i > j
%             S(j,i)=S(i,j);
%         end
%     end
% end
% nu = sym('nu%d%d', [4 1]);
% syms r1 r2 q ref
% R = [r1 0;0 r2];
% Q = q;

% A = [-0.83705 1.7696 -0.35236 0;...
%      -5.9575 -21.766 0.0056738 0.8717;...
%      0 0 0 1;...
%      14.891 -47.637 -0.015802 -7.9269];
% B = [0 3.9397;...
%     -0.91092 0;...
%      0 0;...
%     -30.902 -6.9048];
% C = zeros(4,4);
% C(3,3) = 1;
% A = [0 1 0;...
%      0 0 1;...
%      0 -5000 -110];
% B = [0;0;1];
% 
% C = [1 0 0;0 0 0; 0 0 0];
%S_dot = A'*S + S*A - S*B*(R^(-1))*B'*S + C'*Q*C;

%K = (R^(-1))*B'*S;

%nu_dot = (A-B*K)'*nu + C'*Q*ref;




% A = [0 1 0 0;0 -0.1038 25.5862 0;0 0 0 1;0 -0.5015 238.4685 0];
% B = [0;0.4891;0;2.3634];
% C = [0 0 0 0;0 0 0 0;0 0 1 0;0 0 0 0];
% x0 = [0 0 0 0]';
% Q = [221.5326 0 0 0;0 169.2376 0 0;0 0 121.2542 1;0 0 0 187.6532];
% R = 1.7682;
% ptf = [0 0 0 0;0 0 0 0;0 0 0 0;0 0 0 0];

% A=[0 0 1 0;0 0 0 1;12.49 -12.54 0 0;-14.49 29.36 0 0];
% B=[0 0 -2.98 5.98]';
% C=[1 0 0 0;0 1 0 0;0 0 0 0;0 0 0 0];
% x0=[0 0 0 0]';
% Q = eye(4);
% R = 1;
% ptf = eye(4)*20;

% A = [0 1 0;0 0 1; 0 0 0];
% B = [0 0 1]';
% C = [1 0 0;0 0 0;0 0 0];
% x0 = [0 0 0]';
% Q = [1 0 0; 0 100 0;0 0 150];
% R = 100;
% ptf = [2 0 0;0 2 0;0 0 2];

% A=[ -2.3817 0 -1.0019 2.1827;...
%     -21.063 -16.055 0.87229 0;...
%     24.512 -16.651 -3.5379 0;...
%     0 1.0026 -0.029766 0];
% B=[ 0 -0.24719;...
%     -36.263 -688.44;...
%     -0.67252 -67.983;...
%     0 0];
% C=[1 0 0 0;0 1 0 0;0 0 1 0;0 0 0 1];
% x0=[0 0 0 0]';
% Q=[0.5 0 0 0;0 0.01 0 0;0 0 0.1 0; 0 0 0 100];
% R=[0.05 0;0 0.05];
% ptf=[0 0 0 0;0 0 0 0;0 0 0 0;0 0 0 0];

% A = [0 1;...
%     0 0];
% 
% B = [0;...
%     1];
% 
% C = [1 0;0 0];
% 
% x0 = [15;...
%      25];
% 
% Q = [80 0;...
%    0 1];
% 
% R = 500;
% 
% ptf = [2 0;0 2];

for i=1:no_of_state
    figure 
    plot(t,x(:,i))
    grid on
end